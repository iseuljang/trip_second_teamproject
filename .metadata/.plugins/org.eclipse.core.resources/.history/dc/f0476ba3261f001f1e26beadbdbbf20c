<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="../include/head.jsp" %> 
<link rel="stylesheet" type="text/css" href="../css/masterGonggiwrite.css">    
<%
//-------------------- 값 수령 --------------------
String pageno  = request.getParameter("page");
String advertno  = request.getParameter("advertno");

//페이징 기본설정
if(pageno  == null || pageno.equals("")) 
{
	pageno  = "1";
}

int curpage = 1;
try{
		curpage = Integer.parseInt(pageno);
}catch(Exception e){  }

//------------------ 페이징 설정 ----------------------
advertDTO dto = new advertDTO();
advertVO vo = new advertVO();
int total = dto.GetTotal();
int perPage = 20;
int maxpage = total / perPage;	
if( total % perPage != 0) maxpage++;
//--------------------- 접근제어 ------------------

// 비로그인시
if(login == null)
{
	%>
	<script>
	$(document).ready(function(){
		
		alert("로그인이 필요합니다.");
		if(confirm("로그인 페이지로 이동하시겠습니까?") == true)
		{
			document.location = "../user/login.jsp";
			return;
		}else
		{
			document.location = "../firstmain/lobby.jsp";
			return;
		}
	});
	</script>
	<% 
	return;
}

// 관리자 권한이 없을시
adminboardDTO adto = new adminboardDTO();
adminboardVO avo = new adminboardVO();

if(adto.CheckAdmin(login.getUid()) == false)
{
	%>
	<script>
	$(document).ready(function(){
		
		alert("해당 회원은 관리자 권한이 없습니다.");
		history.back();
		return;
	});
	</script>
	<% 
	return;
}

//게시물 번호 유효성 확인
if(advertno == null || advertno.equals(""))
{
	%>
	<script>
	$(document).ready(function(){
		
		alert("유효하지 않은 공지글입니다.");
		history.back();
		return;
	});
	</script>
	<% 
	return;
}



//--------------------- 공지게시글 목록 조회 ------------------- 
vo = dto.Read(advertno);
if(vo == null || vo.equals(""))
{
	%>
	<script>
	$(document).ready(function(){
		
		alert("해당 공지글을 조회할 수 없습니다.");
		history.back();
		return;
	});
	</script>
	<% 
	return;
}
%>
<style>
.btn
{
	border: 0px; 
	font-size: 25px;
	border-radius: 0.2em;
	cursor: pointer;
	width: 100px;
	height: 50px;
	color: white; 
	margin-bottom : 20px;
}

.xx
{
	border-spacing: 20px 20px;

}
</style>
<script>
//------------------- 공지글 수정 버튼 ----------------------
function DoModify()
{
	 
	 if($("#adtitle").val() == "")
	 {
		 alert("제목을 입력하세요");
		 $("#adtitle").focus();
		 return;
	 }
	 if($("#fname").val() == "")
	 {
		 alert("파일을 업로드 해주세요");
		 return;
	 }
	 if($("#startday").val() == "")
	 {
		 alert("시작일을 입력해주세요");
		 return;
	 }
	 if($("#endday").val() == "")
	 {
		 alert("종료일을 입력해주세요");
		 return;
	 }
	if( confirm("게시물을 수정하시겠습니까?")==true)
	 {
		$("#mastermodify").submit();
	 }
}
</script>
<body>
	<form method="post" name="masterADview" id="masterADview" action="masterADwrite.jsp">
	
	<!-- 중간부분입니다 -->
	<div style="margin-top:100px"></div>
	<div style="margin-top:100px"></div>
	<table border="0" width="90%" style="vertical-align:top;">
		<tr>
			<td id="td1">
				<a href="masterMembercheck.jsp" ><b>회원조회</b></a>
				<hr>
				<a href="masterGonggiwrite.jsp" ><b>공지사항</b></a>
				<hr>
				<a href="masterADindex.jsp" ><b style="color:#1ABC9C">광고 관리</b></a>
				<hr>
			</td>
			<td style="background-color:gray;"></td>
			<td id="td2">
				<table border="0" width="90%" align="center" style="border-collapse: collapse;" id="view">
					<tr>
						<td colspan="5" align="right">
							<% 
							String link_str = "";
							link_str += "advertno=" + vo.getAdvertno(); 
							link_str += "&page=" + pageno; 
							%>
							<button type="button" class ="btn" id="list_btn" style="background-color : green; margin-right : 20px;" 
							onclick="gotoList('<%= page %>')">돌아가기</button>
							<button type="button" class ="btn" id="modify_btn" style="background-color : royalblue; margin-right : 20px;" 
							onclick="modifyBoard('<%= link_str %>')">수정</button>
							<button type="button" class ="btn" id="delete_btn" style="background-color : deeppink;"
							 onclick="deleteBoard('<%= link_str %>');">삭제</button>
						</td>
					</tr>
					<tr class="xx">
						<td>
							<div><h2>상품 카테고리</h2></div> 
							<span>카테고리 :</span>
							<input type="text" value="<%= vo.getCategory() %>">
						</td>
						<td>
							<span> 하위 카테고리 :</span>
							<input type="text" value="<%= vo.getSubclass() %>"> 
						</td>
					</tr>
					<tr class="xx">
						<td>
							<div><h2>1.상품 이름</h2></div>
							<input type="text" value="<%= vo.getProductName() %>">  
						</td>
					</tr>
					<tr class="xx">
						<td>
							<div><h2>2.광고 이미지</h2></div>
							<div><h2>기존 이미지</h2></div>
							<img src="<%= vo.getImageURL() %>">
							새로운 이미지 파일 첨부
							<input type="file">
						</td>
					</tr>
					<tr class="xx">
						<td>
							<div><h2>3.광고 키워드</h2></div>	
							<input type="text" value="아침, 아침식사, 오트, 모닝, 든든 -> 아직 보류">  
						</td>
					</tr>
					<tr class="xx">
						<td align="left">
							<div><h2>4.노출 빈도수 -> 보류</h2></div>
							<table border="1">
								<tr>
									<td>노출 횟수</td>
									<td>노출 날짜</td>
									<td>노출된 게시물</td>
								</tr>
								<tr>
									<td>2</td>
									<td>2024.05.27 20:00</td>
									<td>바르셀로나에서 아침을 어떻게 보내야 할까요</td>
								</tr>
								<tr>
									<td>1</td>
									<td>2024.05.27 18:30</td>
									<td>광주 여행을 갔는데 너무 좋았어요</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
		</tr>
	</table>
	</form>
</body>
</html>